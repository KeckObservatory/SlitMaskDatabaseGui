
<body>


<h3>The mask will be forgotten.  This cannot be undone.</h3>
<h3> <div id="blue-id"></div>
  <div id="design-id"></div> </h3>

<form>
  <button type="button" id='forget-btn', onclick="forgetMask()">Forget about Mask</button>
</form>


<script>
  let apiRootUrl;
  let blueIdParam;
  let designIdParam;

  // show the use date and the design-id
  function loadParams() {
    fetch('MaskConfig.json')
    .then(response => response.json())
    .then(config => {
      apiRootUrl = config.apiRootUrl;
      showId();
    })
    .catch(error => {
      alert(`Error reading configuration: ${error}`);
    });

  }

  function showId() {
    const urlParams = new URLSearchParams(window.location.search);
    blueIdParam = urlParams.get('blue-id');
    if (blueIdParam === null) {
      designIdParam = urlParams.get('design-id');
      const designIdDiv = document.getElementById("design-id")
      designIdDiv.innerText = `Design Id: ${designIdParam}`;
    } else {
      const blueIdDiv = document.getElementById("blue-id");
      blueIdDiv.innerText = `Blueprint Id: ${blueIdParam}`;
    }

  }

  function forgetMask() {
    let apiUrl = "/slitmask/forget-mask"
    let full_url;
    if (blueIdParam === null) {
      full_url = `${apiRootUrl}${apiUrl}?design-id=${designIdParam}`;
    } else {
      full_url = `${apiRootUrl}${apiUrl}?blue-id=${blueIdParam}`;
    }

    // update the Use Date
    fetch(full_url, {
      mode: 'cors',
      credentials: 'include' // cookies
    })
    .then(response => response.json())
    .then(data => {
      queryResults = data.data.msg;
      console.log('stuff', queryResults);
      alert(queryResults);
    })
    .catch(error => {
      alert(`Error accessing data, check API at ${apiRootUrl}${apiUrl}: ${error}`);
    });
  }

  // expose the forgetMask to be used in index.html
  window.onload = forgetMask;

  // load the Date-Use and Design ID
  window.onload = loadParams();
</script>

</body>