<body>

<h3>The Mask Date-of-Use can be extended for up to 365 days.</h3>

<br><br>

<table>
  <tr>
    <th>Mask Design Id</th>
    <th> - </th>
    <th>Mask Blueprint Id</th>
    <th> - </th>
    <th>Mask Design Name</th>
    <th> - </th>
    <th>Current Use Date</th>
    <th> - </th>
    <th>Mask Status</th>
  </tr>
  <tr>
    <td align="center"><div id="design-id"></div></td>
    <td> - </td>
    <td align="center"><div id="blue-id"></div></td>
    <td> - </td>
    <td align="center"><div id="design-name-id"></div></td>
    <td> - </td>
    <td align="center"><div id="use-date-id"></div></td>
    <td> - </td>
    <td align="center"><div id="mask-status-id"></div></td>
  </tr>
</table>

<br><br>
<form>
  <label for="numDays">Number of Days:</label>
  <input type="number" id="numDays" value="0" min="0" max="365"/>
  <button type="button" onclick="updateUseDate()">Set Use Date</button>
</form>

<script>
  let apiRootUrl;

  function updateUseDate() {
    let apiUrl = "/slitmask/extend-mask-use-date"
    setUseDate(apiUrl);
  }

  function setUseDate(apiUrl) {

    // Get the design-id parameter from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const designId = urlParams.get('design-id');

    showCurrentUse(apiRootUrl, designId);

    const numDays = document.getElementById("numDays").value;

    let full_url = `${apiRootUrl}${apiUrl}?design-id=${designId}&number-days=${numDays}`;

    // update the Use Date
    fetch(full_url, {
      mode: 'cors',
      credentials: 'include' // cookies
    })
    .then(response => response.json())
    .then(data => {
      queryResults = data.data;
      console.log('stuff', queryResults);
    })
    .catch(error => {
      alert(`Error accessing data, check API at ${apiRootUrl}${apiUrl}: ${error}`);
    });
  }

  // makes sure the input is only integers
  const inputField = document.getElementById("numDays");

  inputField.addEventListener("input", function() {
    // Get the input value
    const inputValue = inputField.value;

    // Check if the input value is numeric
    if (!isNaN(inputValue)) {
      // Parse the input value as a number
      const numericValue = parseInt(inputValue);

      // Check if the numeric value is greater than 365
      if (numericValue > 365) {
        // If so, set the input value to 365
        inputField.value = 365;
      }
    } else {
      // If the input value is not numeric, set it to an empty string
      inputField.value = "";
    }
  });

  // expose the updateUseDate to be used in index.html
  window.onload = updateUseDate;

  // load the Date-Use and Design ID
  window.onload = loadParams();
</script>

</body>

